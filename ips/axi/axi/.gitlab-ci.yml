variables:
  VSIM: vsim-10.6b -64
  VLIB: vlib-10.6b
  VLOG: vlog-10.6b -64
  SYNOPSYS_DC: synopsys-2016.03 dc_shell -64bit

before_script:
  - export PATH=~fschuiki/.cargo/bin:$PATH
  - mkdir -p build

vsim:
  stage: build
  script:
    - >
      if ! memora lookup vsim; then
        cd build && ../scripts/compile_vsim.sh
        memora insert vsim
      fi

synopsys_dc:
  stage: build
  script:
    - cd build
    - ../scripts/synth.sh

.test_module: &test_module
  stage: test
  script:
    - >
      if ! memora lookup $TEST_MODULE; then
        memora get vsim
        cd build && ../scripts/run_vsim.sh $TEST_MODULE
        memora insert $TEST_MODULE
      fi

axi_to_axi_lite:
  <<: *test_module
  variables:
    TEST_MODULE: axi_to_axi_lite
